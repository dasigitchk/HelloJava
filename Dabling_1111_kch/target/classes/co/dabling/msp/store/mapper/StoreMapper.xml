<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.dabling.msp.store.mapper.StoreMapper">
	<!-- 전체 매장 리스트 -->
	<select id="storeSelectList"
		resultType="co.dabling.msp.store.vo.StoreVO">
		SELECT * FROM STORES ORDER BY STORE_CODE DESC
	</select>

	<!-- 매장1건조회 -->
	<select id="storeSelect" resultType="co.dabling.msp.store.vo.StoreVO">
		select a.STORE_CODE,a.business_num,a.STORE_NAME,a.STORE_REGION,a.STORE_CATEGORY,a.STORE_INFO,a.LAT,LNG,a.STORE_IMAGE,a.STORE_ADDRESS
		from stores a 
		    left join members b
		    on a.business_num = b.business_num
		    where a.business_num = #{businessNum}
	</select>

	<!-- 매장등록(승인신청) -->
	<insert id="storeInsert">
	INSERT INTO STORES(STORE_CODE,STORE_NAME,STORE_REGION,STORE_CATEGORY,STORE_INFO,LAT,LNG,STORE_IMAGE,STORE_ADDRESS,business_num)
			VALUES(storeCode_seq.nextval,#{storeName},#{storeRegion},#{storeCategory},#{storeInfo},#{lat},#{lng},#{storeImage},#{storeAddress},#{businessNum})
	</insert>

	<!-- 매장 정보 수정 -->
	<update id="storeUpdate">
		UPDATE STORES
		SET STORE_NAME =
		NVL(#{storeName},store_name),
		STORE_REGION =
		NVL(#{storeRegion},store_region),
		STORE_CATEGORY =
		NVL(#{storeCategory},store_category),
		STORE_INFO =
		NVL(#{storeCategory},store_info),
		LAT = NVL(#{lat},lat),
		LNG =
		NVL(#{lng},lng),
		STORE_IMAGE = NVL(#{storeImage},store_image),
		STORE_ADDRESS = NVL(#{storeAddress},store_address),
		STORE_IMAGE_RENAME = NVL(#{storeImageRename},store_image_rename)
		WHERE BUSINESS_NUM
		= #{businessNum }
	</update>
	
	<!-- 매장 등록 승인 -->
	<update id="storeApproval">
		UPDATE STORES
		SET APPROVAL_STATE = 1
		WHERE BUSINESS_NUM = #{businessNum}
	</update>

	<!-- 매장 정보 삭제 -->
	<delete id="storeDelete">
		DELETE FROM STORES
		WHERE BUSINESS_NUM = #{businessNum}
	</delete>

</mapper>

